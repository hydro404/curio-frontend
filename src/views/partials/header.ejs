<% let grandTotal = 0; cartItems.forEach(function(item) {
  grandTotal += item.qty * item.price; }); %>
<!-- Remove "navbar-sticky" class to make navigation bar scrollable with the page.-->
<div class="navbar-sticky bg-light">
  <div class="navbar navbar-expand-lg navbar-light">
    <div class="container">
      <a class="navbar-brand d-none d-sm-block flex-shrink-0" href="/"
        ><img src="img/logo.svg" width="170" alt="Curio 4552" /></a
      ><a class="navbar-brand d-sm-none flex-shrink-0 me-2" href="/"
        ><img src="img/logo.svg" width="100" alt="Curio 4552"
      /></a>

      <div class="navbar-toolbar d-flex flex-shrink-0 align-items-center">
        <a class="navbar-tool d-none d-lg-flex" href="/account-wishlist"
          ><span class="navbar-tool-tooltip">Wishlist</span>
          <div class="navbar-tool-icon-box">
            <i class="navbar-tool-icon ci-heart"></i></div></a
        ><a
          class="navbar-tool ms-1 ms-lg-0 me-n1 me-lg-2"
          href="#signin-modal"
          data-bs-toggle="modal"
        >
          <div class="navbar-tool-icon-box">
            <i class="navbar-tool-icon ci-user"></i>
          </div>
          <div class="navbar-tool-text ms-n3">
            <small>Hello, Sign in</small>My Account
          </div></a
        >
        <div class="navbar-tool dropdown ms-3">
          <a
            class="navbar-tool-icon-box bg-secondary dropdown-toggle"
            href="/cart"
            ><span class="navbar-tool-label"><%- totalCartItems %></span
            ><i class="navbar-tool-icon ci-cart"></i></a
          ><a class="navbar-tool-text" href="/cart"
            >
            <small>My Cart</small>&#8369;<%= grandTotal.toFixed(2) %></a
          >
          <!-- Cart dropdown-->
          <div class="dropdown-menu dropdown-menu-end">
            <div class="widget widget-cart px-3 pt-2 pb-3" style="width: 20rem">
              <div
                style="height: 15rem"
                data-simplebar
                data-simplebar-auto-hide="false"
              >
                <!-- Iterate over each item in the cartItems array and display -->
                <% cartItems.forEach((item, index) => { %>
                <div class="widget-cart-item pb-2 border-bottom">
                  <button
                    class="btn-close text-danger"
                    type="button"
                    aria-label="Remove"
                  >
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <div class="d-flex align-items-center">
                    <a class="flex-shrink-0" href="/product?id=<%= item.id %>">
                      <img
                        src="img/<%= item.image[0] %>"
                        width="64"
                        alt="<%= item.name %>"
                      />
                    </a>
                    <div class="ps-2">
                      <h6 class="widget-product-title">
                        <a href="/product?id=<%= item.id %>"
                          ><%= item.name %></a
                        >
                      </h6>
                      <div class="widget-product-meta">
                        <span class="text-accent me-2"
                          >&#8369;<%= item.price %></span
                        >
                        <span class="text-muted">x <%= item.qty %></span>
                      </div>
                    </div>
                  </div>
                </div>
                <% }); %>
              </div>
              <div
                class="d-flex flex-wrap justify-content-between align-items-center py-3"
              >
                <div class="fs-sm me-2 py-2">
                  <span class="text-muted">Subtotal:</span
                  ><span class="text-accent fs-base ms-1">&#8369; <%= grandTotal.toFixed(2) %></span>
                    </span
                  >
                </div>
                <a class="btn btn-outline-secondary btn-sm" href="/cart"
                  >Expand cart<i class="ci-arrow-right ms-1 me-n1"></i
                ></a>
              </div>
              <a
                class="btn btn-primary btn-sm d-block w-100"
                href="/checkout"
                ><i class="ci-card me-2 fs-base align-middle"></i>Checkout</a
              >
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
